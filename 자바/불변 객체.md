

### 불변 클래스란?
- 인스턴스의 내부 값을 수정할 수 없는 클래스!
- 불변 인스턴스에 가지고 있는 정보는 고정 객체가 파괴될 때 까지 절대 변하지 않는다


### 불변클래스의 장점과 그 이유
- **불변 객체는 단순하다**
- **불변 클래스는 가변 클래스보다 구현하고 사용하기 쉬우며 오류 발생 여지도 적다.**
  **반면 가변 객체는 임의의 복잡한 상태에 놓일 수 있음.**
- **불변 객체를 근본적으로 스레드에 안전하여 따로 동기화할 필요가 없다.**




### 불변클래스의 5가지 규칙
**1. 객체의 상태를 변경하는 메서드(변경자)를 제공하지 않는다.**

**2. 클래스를 확장할 수 없도록 한다**
- 하위 클래스에서 다른 의도로 객체의 상태를 변경하는 것을 막아줌.
- 상속을 막는 대표적인 방법은 final 로 선언하는 것.

**3. 모든 필드를 final로 선언한다.**
- 시스템이 강제하는 수단을 통해 의도를 명확하게 드러낸다.

**4. 모든 필드를 private로 선언한다.**
- 필드가 참조하는 가변 객체를 클라이언트에서 직접 접근을 막으며 수정하는 것을 막아준다.
- 불변 객체를 참조하는 필드를 public final 로 선언하여 불변 객체로 만들 수 있지만 이 방법은 다음 릴리스에서 내부 표현을 바꾸지 못해 권하지 않음.

**5. 자신 외에는 내부의 가변 컴포넌트에 접근 할 수 없도록 한다.**
- 클래스에 가변 객체를 참조하는 필드가 하나라도 있으면 클라이언트에서 그 객체의 참조를 접근 할 수 없도록 해야 한다.
- 절대 클라이언트가 제공한 객체 참조를 가리케게 해서는 안됨
- 생성자, 접근자, readObject메서드 모두에서 방어적 복사를 수행해야 한다.



불변 객체는 공유에 자유로울 뿐 아니라 불변 객체끼리 내부 데이터를 공유 할 수 있다.

### 불변 클래스의 단점
**값이 다르면 반드시 독립된 객체로 만들어야 한다.**



### 자신을 상속하지 못하게 하는 방법

**가장 쉬운 방법은 final 클래스로 선언**

**더 유연한 방법이 있다!**
**모든 생성자를 private 혹은 package-private으로 만들고 public 정적 팩터리를 제공**
- 클라이언트에서 바라본 객체는 생성자가 없으니 이 클래스를 확장하는 게 불가능 하기 때문
- 다수의 구현 클래스를 활용한 유연성을 제공하고 이에 더해 다음 릴리스에서 객체 캐싱 기능을 추가해 성능을 끌어올릴 수도 있다.



> 클래스는 꼭 필요한 경우가 아니라면 불변이어야 한다.
> 불변 클래스는 장점이 많으며 단점이라곤 특정 상황에서의 잠재적 성능 저하뿐
> 불변으로 만들 수 없는 클래스라도 변경할 수 있는 부분을 최소한으로 바꾸자.