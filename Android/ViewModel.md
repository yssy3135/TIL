**ViewModel클래스는 수명 주기를 고려하여 UI관련 데이터를 저장하고 관리하도록 설계되었다.**

**ViewModel클래스를 사용하면 회전과 같이 구성을 변경할 때도 데이터를 유지할 수 있다.**

Android 프레임워크는 활동과 프래그먼트 같은 **UI컨트롤러의 수명주기를 관리한다**.

프레임워크는 특정 사용자 작업이나 완전히 통제할 수 없는 기기 이벤트에 대한 응답으로 UI컨트롤러를 제거하거나 다시 만들도록 결정할 수 있다.

시스템에서 UI컨트롤러를 제거하거나 다시 만드는 경우, 컨트롤러에 저장된 모든 일시적인 UI 관련 데이터가 삭제된다.

예를들어 앱 활동 중 하나에 사용자 목록이 포함되어 있는데, 구성이 변경되어 활동이 다시 생성되면 새 활동이 사용자 목록을 다시 가져와야 한다.

데이터가 단순한 경우 활동은 onSaveInstanceState()메서드를 사용하여 onCreate()의 번들에서 데이터를 복원할 역직렬화할 수 있는 소량의 데이터에만 적합하다.

다른문제는 UI 컨트롤러가 반환하는 데 시간이 걸릴수 있는 비동기 호출을 자주 해야 한다.

UI컨트롤러는 비동기 호출을 관리해야하며, 메모리 누수 가능성을 방지하기 위해 호출이 제거된 후 시스템에서 호출을 정리하는지 확인해야 한다.

관리에는 많은 유지관리가 필요하며, 구성 변경시 개체가 다시 생성되는 경우 개체가 이미 수행된 호출을 다시 호출해야 할 수 있으므로 리소스가 낭비된다.

활동 및 프래그먼트와 같은 **UI 컨트롤러의 목적은 기본적으로 UI 데이터를 표시하거나, 사용자 작업에 반응하거나, 권한 요청과 같은 운영체제 커뮤니케이션을 처리하는 것입니다**. 또한 **UI 컨트롤러에 데이터베이스나 네트워크에서 데이터 로드를 책임지도록 요구하면 클래스가 팽창됩니다.** UI 컨트롤러에 과도한 책임을 할당하면 다른 클래스로 작업이 위임되지 않고, 단일 클래스가 혼자서 앱의 작업을 모두 처리하려고 할 수 있습니다. 또한 이런 방법으로 UI 컨트롤러에 과도한 책임을 할당하면 테스트가 훨씬 더 어려워집니다.

**UI 컨트롤러 로직에서 뷰 데이터 소유권을 분리하는 방법이 훨씬 쉽고 효율적입니다.**

## ViewModel 구현

UI 컨트롤러에 VIewModel 클래스를 제공한다.

ViewModel 객체는 구성이 변경되는 동안 자동으로 보관되므로, 이러한 객체가 보유한 데이터는 다음 활동 또는 프래그먼트 인스턴스에서 즉시 사용할 수 있다.

### ViewModel의 수명주기

ViewModel의 객체의 범위는 ViewModel을 가져올때 ViewModelProvider에 전달되는 Lifecycle로 지정된다.

ViewModel은 범위가 지정된 Lifecycle이 영구적으로 경과될 때까지, 즉 Activity에서는  Activity가 끝날 때까지 그리고 프래그먼트에서는 프래그먼트가 분리될 때까지 메모리에 남아 있다.
![](image/img_1.png)
