
# 1. 도메일 모델 시작하기

****************************도메인이란 ?****************************

- 소프트웨어로 해결하고자 하는 문제영역, 즉 도메인
- 한 도메인은 다시 하위 도메인으로 나눌 수 있다.
- 도메인이 제공해야할 모든 기능을 직접 구현하는 것은 아님 외부 시스템을 사용할 수도 있다.
- 도메인 마다 고정된 하위 도메인이 존재하는 것은 아니다.

  하위 도메인을 어떻게 구성할지 여부는 상황에 따라 달라진다.

![domain.png](image%2Fdomain.png)

### 요구사항

- 요구사항을 올바르게 이해하는 것이 중요.
- 요구사항을 올바르게 이해하지 못하면 요구하지 않은 엉뚱한 기능을 만들게 된다.
- 요구사항을 올바르게 이해하기 위해 개발자와 전문가가 직접 대화해야 한다.
- 도메인 전문가, 관계자, 개발자가 같은 지식을 공유하고 직접 소통할수록 도메인 전문가가 원하는 제품을 만들 가능성이 높아짐.

### **************************도메인 모델**************************

- 도메인 모델은 특정 도메인을 개념적으로 표현한 것.
- 도메인 모델을 사용하면 여러 관계자들이 동일한 모습으로 도메인을 이해하고 도메인 지식을 공유하는데 도움이 된다.
- 도메인 을 이해하려면 도메인이 제공하는 기능과 도메인의 주요 데이터 구성을 파악해야함.

  이런면에서 기능과 데이터를 함께 보여주는 객체모델은 도메인을 모델링 하기에 적합.

- 도메인 모델을  클래스 다이어그램, 상태다이어그램과 같은 UML 표기법만 사용해야하는 것은 아님

  관계가 중요하다면 그래프, 계산 규칙이 중요하다면 수학 공식을 활용해 도메인 모델을 만들 수 있음.

- 도메인 모델은 기본적으로 도메인 자체를 이해기 위한 개념모델
- 개념 모델을 이용해서 바로 개발에 들어갈 수 없다 구현 기술에 맞는 구현 모델이 따로 필요

### 도메인 모델 패턴

**도메인 모델 패턴이란?**

- 도메인 모델은 아키텍처 상의 도메인 계층을 객체지향 기법으로 구현하는 패턴.
- 도메인 규칙을 객체 지향 기법으로 구현하는 패턴
- **핵심 규칙을 구현한 코드는 도메인 모델에만 위치하기 때문에 규칙이 바뀌거나 규칙을 확장해야 할 때 다른 코드에 영향을 덜 주고 변경 내역을 모델에 반영할 수 있게 된다.**

************************************************개념모델과 구현 모델************************************************

- 개념모델은 순수하게 문제를 분석할 결과물, 구현기술이나 성능을 고려하지 않음.
- 실제 코드를 작성할 때 개념모델을 그대로 사용할 수 없다.
- 개념모델을 구현 가능한 형태의 구현모델로 전환하는 과정을 거치게 됨.

**도메인 모델링**

도메인을 모델링할 때 기본이 되는 작업은 모델을 구성하는 핵심 구성요소, 규칙, 기능을 찾는 것.

이 과정을 요구사항 에서 출발

********************************엔티티와 밸류********************************

도출한 모델은 크게 엔티티와 밸류로 구분

**Entity**

- 객체의 생명주기 내내 이어지는 추상적인 연속성과 식별성을 가진다.
- 각 Entity는 고유해서 서로 다른 식별자를 가진다.
- 식별에 사용되는 속성은 시스템 내에서 유일해야 한다.

**************************************엔티티의 식별자**************************************

식별자를 생성하는 시점은 도메인의 특징과 사용하는 기술에 따라 달라짐.

- 특정규칙에 따라 생성
- UUID나 Nano ID 같은 고유 식별자 생성기 사용
- 값을 직접 입력
- 일련번호 사용(시퀀스나 DB의 자동 증가 컬럼 사용)

**ValueObject**

- 개념적 식별성을 갖지 않으면서 도메인의 서술 측면을 나타내는 객체
- 어느것인지는 관심이없고, 무엇인지(값) 에만 관심
- 개념적으로 완전한 하나를 표현
- ValueObject는 불변(immutable) 해야 한다.

  불변하므로 참조 투명성, 스레드 세이프

  복사와, 공유와 같은 문제에 관해 자유로워 질 수 있다.


**********************************************식별자와 밸류타입**********************************************

식별자는 단순한 문자열이 아니라 도메인에서 특별한 의미를 지니는 경우가 많기 때문에 식별자를 위한 밸류 타입을 사용해서 의미가 잘 드러나도록 할 수 있다.

예) 주문번호를 표현하기 위해 Order의 식별자 타입으로 String 대신 OrderNo 밸류타입을 사용

******************************************************************도메인 모델에 set메서드 넣지 않기******************************************************************

- 도메인의 핵심 개념이나 의도를 코드에서 사라지게 한다.
- 도메인 객체를 생성할 때 온전하지 않은 상태가 될 수 있다.
- 불변 밸류 탕입을 사용하면 자연스럽게 밸류 타입에는 set메서드를 구현하지 않는다.
- set 메서드를 구현해야 할 특별한 이유가 없다면 불변 타입의 장점을 살릴 수 있도록 밸류 타입은 불변으로 구현한다.

**유비쿼터스 언어**

- 전문가, 관계자, 개발자가 도메인과 관련된 공통의 언어를 만들고 이를 대화, 문서, 도메인 모델, 코드, 테스트등 모든 곳에서 같은 용어를 사용
- 소통과정에서 발생하는 용어의 모호함을 줄일 수 있고 개발자는 도메인과 코드 사이에서 불필요한 해석 과정을 줄일 수 있다.
- 적당한 단어를 찾는 노력을 하지 않고 도메인에 어울리지 않은 단어를 사용하면 코드는 도메인과 점점 멀어진다.

